---
interface BreadcrumbItem {
  name: string;
  url: string;
}

interface Props {
  items?: BreadcrumbItem[];
}

const { items } = Astro.props;

// URL-Segmente zu lesbaren Namen (Fallback wenn keine items übergeben)
const segmentNames: Record<string, string> = {
  'ratgeber': 'Ratgeber',
  'hausaufloesung-berlin': 'Hausauflösung Berlin',
  'haushaltsaufloesung-berlin': 'Haushaltsauflösung Berlin',
  'entruempelung-berlin': 'Entrümpelung Berlin',
  'nachlassverwertung-berlin': 'Nachlassverwertung Berlin',
  'seniorenumzug-wohnungsaufloesung': 'Seniorenumzug',
  'wohnungsaufloesung-todesfall': 'Wohnungsauflösung Todesfall',
  'gewerbeaufloesung-berlin': 'Gewerbeauflösung Berlin',
  'bueroaufloesung-berlin': 'Büroauflösung Berlin',
  'praxisaufloesung-berlin': 'Praxisauflösung Berlin',
  'restaurantaufloesung-berlin': 'Restaurantauflösung Berlin',
  'firmenaufloesung-berlin': 'Firmenauflösung Berlin',
  'lageraufloesung-berlin': 'Lagerauflösung Berlin',
  'fuer-insolvenzverwalter': 'Für Insolvenzverwalter',
  'fuer-hausverwaltungen': 'Für Hausverwaltungen',
  'fuer-makler': 'Für Makler',
  'berlin-steglitz-zehlendorf': 'Steglitz-Zehlendorf',
  'berlin-charlottenburg-wilmersdorf': 'Charlottenburg-Wilmersdorf',
  'brandenburg-potsdam-umland': 'Potsdam & Umland',
  'wohnungsaufloesung-zehlendorf': 'Zehlendorf',
  'wohnungsaufloesung-dahlem': 'Dahlem',
  'wohnungsaufloesung-charlottenburg': 'Charlottenburg',
  'wohnungsaufloesung-grunewald': 'Grunewald',
  'wohnungsaufloesung-schmargendorf': 'Schmargendorf',
  'wohnungsaufloesung-potsdam': 'Potsdam',
  'wohnungsaufloesung-kleinmachnow': 'Kleinmachnow',
  'wohnungsaufloesung-kosten': 'Kosten',
  'wohnungsaufloesung-durch-betreuer': 'Durch Betreuer',
  'ueber-uns': 'Über uns',
  'kontakt': 'Kontakt',
  'faq': 'FAQ',
  'impressum': 'Impressum',
  'datenschutz': 'Datenschutz',
};

function buildBreadcrumbs(): BreadcrumbItem[] {
  if (items && items.length > 0) return items;

  const segments = Astro.url.pathname.split('/').filter(Boolean);
  const result: BreadcrumbItem[] = [{ name: 'Home', url: '/' }];

  let accumulatedPath = '';
  segments.forEach((segment) => {
    accumulatedPath += `/${segment}`;
    const name = segmentNames[segment] || segment.charAt(0).toUpperCase() + segment.slice(1).replace(/-/g, ' ');
    result.push({ name, url: accumulatedPath + '/' });
  });

  return result;
}

const breadcrumbList = buildBreadcrumbs();
---

<nav aria-label="Breadcrumb" class="container mx-auto px-4 py-3 text-sm text-gray-500">
  <ol class="flex flex-wrap items-center gap-1">
    {breadcrumbList.map((crumb, index) => (
      <li class="flex items-center">
        {index > 0 && <span class="mx-1.5 text-gray-400" aria-hidden="true">/</span>}
        {index < breadcrumbList.length - 1 ? (
          <a href={crumb.url} class="hover:text-primary transition-colors">
            {crumb.name}
          </a>
        ) : (
          <span class="text-gray-700 font-medium" aria-current="page">{crumb.name}</span>
        )}
      </li>
    ))}
  </ol>
</nav>
